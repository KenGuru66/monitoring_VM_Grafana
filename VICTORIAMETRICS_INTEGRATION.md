# VictoriaMetrics Integration - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–í–µ—Ä—Å–∏—è**: 1.2.31  
**–î–∞—Ç–∞**: 2025-11-20

## –û–±–∑–æ—Ä

–ú–æ–¥—É–ª—å `victoriametrics_client.py` –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å VictoriaMetrics –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–∞—Å—Å–∏–≤–æ–≤ Huawei Dorado –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏—Ö –≤ Excel –æ—Ç—á—ë—Ç–∞—Ö.

### –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ bandwidth, latency, CPU –º–µ—Ç—Ä–∏–∫ –∏–∑ VictoriaMetrics
- ‚úÖ –£–º–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –ø–µ—Ä–∏–æ–¥–∞ –∞–Ω–∞–ª–∏–∑–∞
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –µ–¥–∏–Ω–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏—è
- ‚úÖ –ê–≥—Ä–µ–≥–∞—Ü–∏—è –ø–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞–º (max/median)
- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–æ—Ä–æ–≥–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–æ–¥–µ–ª–∏ –º–∞—Å—Å–∏–≤–∞
- ‚úÖ Graceful handling (–ø—Ä–æ–ø—É—Å–∫ —Å–µ–∫—Ü–∏–∏ –µ—Å–ª–∏ VM –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞)

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     health_check.py                          ‚îÇ
‚îÇ                 (Phase 3: Report Generation)                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                      ‚îÇ
                      ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     log_parser.py                            ‚îÇ
‚îÇ          get_performance_metrics() ‚Üê reference_date          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                      ‚îÇ
                      ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ               victoriametrics_client.py                      ‚îÇ
‚îÇ                VictoriaMetricsClient                         ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ‚Ä¢ check_availability()                                      ‚îÇ
‚îÇ  ‚Ä¢ get_last_datapoint_time(sn)                              ‚îÇ
‚îÇ  ‚Ä¢ get_time_range_last_full_week(reference_date)            ‚îÇ
‚îÇ  ‚Ä¢ get_all_performance_stats(sn, reference_date)            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                      ‚îÇ
                      ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                VictoriaMetrics API                           ‚îÇ
‚îÇ          http://localhost:8428/api/v1/query                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –ø–µ—Ä–∏–æ–¥–∞ –∞–Ω–∞–ª–∏–∑–∞

### –ë–∞–∑–æ–≤—ã–π –ø—Ä–∏–Ω—Ü–∏–ø

–ü–µ—Ä–∏–æ–¥ –∞–Ω–∞–ª–∏–∑–∞: **–ø–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–ª–Ω–∞—è –Ω–µ–¥–µ–ª—è (–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫-–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ)** –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–Ω–æ–π –¥–∞—Ç—ã.

### –ê–ª–≥–æ—Ä–∏—Ç–º –≤—ã–±–æ—Ä–∞ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–Ω–æ–π –¥–∞—Ç—ã

```python
effective_date = None

if reference_date AND last_VM_datapoint:
    # –û—Å–Ω–æ–≤–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π: –µ—Å—Ç—å –∏ –¥–∞—Ç–∞ –ª–æ–≥–æ–≤, –∏ –¥–∞–Ω–Ω—ã–µ –≤ VM
    effective_date = min(last_VM_datapoint, reference_date)
    # –ù–µ –±–µ—Ä—ë–º –¥–∞–Ω–Ω—ã–µ —Å–≤–µ–∂–µ–µ –ª–æ–≥–æ–≤!

elif reference_date:
    # –ï—Å—Ç—å –¥–∞—Ç–∞ –ª–æ–≥–æ–≤, –Ω–æ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –≤ VM –¥–ª—è —ç—Ç–æ–≥–æ SN
    effective_date = reference_date

elif last_VM_datapoint:
    # –ù–µ—Ç –¥–∞—Ç—ã –ª–æ–≥–æ–≤, –Ω–æ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ VM
    effective_date = last_VM_datapoint

else:
    # Fallback: –Ω–µ—Ç –Ω–∏ –¥–∞—Ç—ã –ª–æ–≥–æ–≤, –Ω–∏ –¥–∞–Ω–Ω—ã—Ö –≤ VM
    effective_date = datetime.now()
```

### –ü—Ä–∏–º–µ—Ä—ã

#### –ü—Ä–∏–º–µ—Ä 1: –î–∞–Ω–Ω—ã–µ VM —Å–≤–µ–∂–µ–µ –ª–æ–≥–æ–≤

```
–î–∞—Ç–∞ –ª–æ–≥–æ–≤:         2025-10-02
–ü–æ—Å–ª–µ–¥–Ω—è—è —Ç–æ—á–∫–∞ VM: 2025-10-16

–í—ã–±—Ä–∞–Ω–Ω–∞—è –¥–∞—Ç–∞: min(2025-10-16, 2025-10-02) = 2025-10-02
–ü–µ—Ä–∏–æ–¥ –º–µ—Ç—Ä–∏–∫:  2025-09-22 - 2025-09-28 (–ø–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–ª–Ω–∞—è –Ω–µ–¥–µ–ª—è –î–û 2 –æ–∫—Ç—è–±—Ä—è)
```

#### –ü—Ä–∏–º–µ—Ä 2: –î–∞–Ω–Ω—ã–µ VM —Å—Ç–∞—Ä–µ–µ –ª–æ–≥–æ–≤

```
–î–∞—Ç–∞ –ª–æ–≥–æ–≤:         2025-10-25
–ü–æ—Å–ª–µ–¥–Ω—è—è —Ç–æ—á–∫–∞ VM: 2025-10-16

–í—ã–±—Ä–∞–Ω–Ω–∞—è –¥–∞—Ç–∞: min(2025-10-16, 2025-10-25) = 2025-10-16
–ü–µ—Ä–∏–æ–¥ –º–µ—Ç—Ä–∏–∫:  2025-10-09 - 2025-10-15 (–ø–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–ª–Ω–∞—è –Ω–µ–¥–µ–ª—è –∏–∑ VM)
```

#### –ü—Ä–∏–º–µ—Ä 3: –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è SN –≤ VM

```
–î–∞—Ç–∞ –ª–æ–≥–æ–≤:         2025-10-02
–ü–æ—Å–ª–µ–¥–Ω—è—è —Ç–æ—á–∫–∞ VM: None (–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç—Ç–æ–≥–æ SN)

–í—ã–±—Ä–∞–Ω–Ω–∞—è –¥–∞—Ç–∞: 2025-10-02 (–¥–∞—Ç–∞ –ª–æ–≥–æ–≤)
–ü–µ—Ä–∏–æ–¥ –º–µ—Ç—Ä–∏–∫:  2025-09-22 - 2025-09-28
```

---

## –£–ª—É—á—à–µ–Ω–∏—è R:W Ratio Analysis (v1.2.30)

### –£–≤–µ–ª–∏—á–µ–Ω –ø–µ—Ä–∏–æ–¥ –¥–∞–Ω–Ω—ã—Ö

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ**: –ü–µ—Ä–∏–æ–¥ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ VictoriaMetrics —É–≤–µ–ª–∏—á–µ–Ω —Å ¬±45 –¥–Ω–µ–π –¥–æ **¬±90 –¥–Ω–µ–π**

**–§–∞–π–ª**: `batch_processing/generate_management_report.py`

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- –û–±—â–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω –∞–Ω–∞–ª–∏–∑–∞: 180 –¥–Ω–µ–π (–≤–º–µ—Å—Ç–æ 90)
- –ë–æ–ª—å—à–µ —à–∞–Ω—Å–æ–≤ –∑–∞—Ö–≤–∞—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Å–µ—Ö 51 –º–∞—Å—Å–∏–≤–∞
- –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø–æ–∫—Ä—ã—Ç–∏—è —Å ~40 –¥–Ω–µ–π –¥–æ ~60-80 –¥–Ω–µ–π –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –º–∞—Å—Å–∏–≤–æ–≤

### –£–ª—É—á—à–µ–Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç—å –≤—ã–±–æ—Ä–∫–∏

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ**: –®–∞–≥ –≤—ã–±–æ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω —Å 5 –º–∏–Ω—É—Ç –Ω–∞ **1 –º–∏–Ω—É—Ç—É**

**–§–∞–π–ª**: `analysis/analyze_rw_ratio.py`

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- –í 5 —Ä–∞–∑ –±–æ–ª—å—à–µ —Ç–æ—á–µ–∫ –¥–∞–Ω–Ω—ã—Ö (~50,000 –≤–º–µ—Å—Ç–æ ~10,000 –Ω–∞ –º–∞—Å—Å–∏–≤)
- –ë–æ–ª–µ–µ —Ç–æ—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç median/p75/p95 –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª–µ–π
- –õ—É—á—à–µ–µ –≤—ã—è–≤–ª–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –Ω–∞–≥—Ä—É–∑–∫–∏

**–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**:
- –ó–∞–ø—Ä–æ—Å—ã –∫ VM –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å ~2-3x –º–µ–¥–ª–µ–Ω–Ω–µ–µ
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–ø—É—Å–∫–∞—Ç—å –∞–Ω–∞–ª–∏–∑ –≤ –Ω–µ–ø–∏–∫–æ–≤–æ–µ –≤—Ä–µ–º—è

### –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

**–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è**: `save_detailed_statistics()` –≤ `analysis/analyze_rw_ratio.py`

**–§–æ—Ä–º–∞—Ç –ª–æ–≥-—Ñ–∞–π–ª–∞**: `analysis/rw_ratio_detailed_YYYY-MM-DD.log`

**–°–æ–¥–µ—Ä–∂–∏—Ç**:
- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –∫–∞–∂–¥–æ–º—É –º–∞—Å—Å–∏–≤—É:
  - –ü–µ—Ä–∏–æ–¥ –¥–∞–Ω–Ω—ã—Ö (–¥–∞—Ç—ã –Ω–∞—á–∞–ª–∞ –∏ –∫–æ–Ω—Ü–∞)
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫ –¥–∞–Ω–Ω—ã—Ö –∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
  - R:W –º–µ—Ç—Ä–∏–∫–∏ (median, P75, P95)
  - –¢–∏–ø workload (Write-heavy/Read-heavy/Balanced)
- Summary —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
  - –°—Ä–µ–¥–Ω–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
  - –ü–æ–∫—Ä—ã—Ç–∏–µ –ø–µ—Ä–∏–æ–¥–∞ (Full/Partial/Limited)
  - –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ workload

**–ù–æ–≤—ã–µ –ø–æ–ª—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö**:
```python
{
    'first_timestamp': int,      # Unix timestamp –ø–µ—Ä–≤–æ–π —Ç–æ—á–∫–∏
    'last_timestamp': int,       # Unix timestamp –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ç–æ—á–∫–∏
    'period_days': float,        # –†–µ–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä–∏–æ–¥–∞
    'controllers_count': int     # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
}
```

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**:
```bash
# –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ R:W ratio analysis
cat analysis/rw_ratio_detailed_2025-11-20.log

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ –¥–∞–Ω–Ω—ã—Ö
grep "Period Coverage" analysis/rw_ratio_detailed_2025-11-20.log
```

---

## –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ (v1.2.31)

### –ü—Ä–æ–±–ª–µ–º–∞

–ë–æ–ª—å—à–∏–µ –ø–µ—Ä–∏–æ–¥—ã (180 –¥–Ω–µ–π) —Å –º–∞–ª—ã–º step (1m –∏–ª–∏ 5m) –≤—ã–∑—ã–≤–∞—é—Ç –æ—à–∏–±–∫—É 422 –≤ VictoriaMetrics –∏–∑-–∑–∞ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ—á–µ–∫ –¥–∞–Ω–Ω—ã—Ö:
- 180 –¥–Ω–µ–π √ó step=1m = ~259,200 —Ç–æ—á–µ–∫ ‚Üí –æ—à–∏–±–∫–∞ 422
- 180 –¥–Ω–µ–π √ó step=5m = ~51,840 —Ç–æ—á–µ–∫ ‚Üí –æ—à–∏–±–∫–∞ 422

### –†–µ—à–µ–Ω–∏–µ

–î–≤—É—Ö—ç—Ç–∞–ø–Ω–∞—è –∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è:

#### 1. –ü–æ–∏—Å–∫ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ (step=1d)

**Reference –ø–µ—Ä–∏–æ–¥**: ¬±90 –¥–Ω–µ–π (180 –¥–Ω–µ–π) - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ–∏—Å–∫–∞ –¥–∞–Ω–Ω—ã—Ö

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±—ã—Å—Ç—Ä—ã–π –∑–∞–ø—Ä–æ—Å —Å `step=1d`:
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≥–¥–µ —Ä–µ–∞–ª—å–Ω–æ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ reference –¥–∏–∞–ø–∞–∑–æ–Ω–µ
- –†–µ–∑—É–ª—å—Ç–∞—Ç: `actual_start`, `actual_end`, `period_days`

**–ú–µ—Ç–æ–¥**: `VictoriaMetricsClient.find_real_data_period()`

```python
actual_start, actual_end, period_days = vm_client.find_real_data_period(
    serial_number='2102352VUV10L6000008',
    metric_name='huawei_avg_cpu_usage_percent',
    ref_start=1751576400,  # ¬±90 –¥–Ω–µ–π –æ—Ç reference date
    ref_end=1767128400
)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: (1757106000, 1760562000, 40.0)  # 40 –¥–Ω–µ–π —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```

#### 2. –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä step

–ü–æ—Å–ª–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π step:

**–î–ª—è bandwidth/latency/CPU** (bucket_analysis, advanced_metrics, peak_load):
- –ü–µ—Ä–∏–æ–¥ ‚â§ 45 –¥–Ω–µ–π ‚Üí `step=5m` (–¥–æ 12,960 —Ç–æ—á–µ–∫)
- –ü–µ—Ä–∏–æ–¥ > 45 –¥–Ω–µ–π ‚Üí `step=10m` (–¥–æ 12,960 —Ç–æ—á–µ–∫ –∑–∞ 90 –¥–Ω–µ–π)

**–î–ª—è R:W Ratio** (—Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ–π —Ç–æ—á–Ω–æ—Å—Ç–∏):
- –ü–µ—Ä–∏–æ–¥ ‚â§ 14 –¥–Ω–µ–π ‚Üí `step=1m` (–¥–æ 20,160 —Ç–æ—á–µ–∫)
- –ü–µ—Ä–∏–æ–¥ > 14 –¥–Ω–µ–π ‚Üí `step=5m` (–¥–æ 12,960 —Ç–æ—á–µ–∫ –∑–∞ 45 –¥–Ω–µ–π)

### –ü—Ä–∏–º–µ—Ä—ã

#### –ü—Ä–∏–º–µ—Ä 1: –ú–∞—Å—Å–∏–≤ —Å –∫–æ—Ä–æ—Ç–∫–∏–º –ø–µ—Ä–∏–æ–¥–æ–º –¥–∞–Ω–Ω—ã—Ö

```
Reference –ø–µ—Ä–∏–æ–¥: ¬±90 –¥–Ω–µ–π (180 –¥–Ω–µ–π)
–†–µ–∞–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥:  2025-10-09 - 2025-10-16 (7 –¥–Ω–µ–π)

Bucket analysis: step=5m (7 –¥–Ω–µ–π √ó 288 —Ç–æ—á–µ–∫/–¥–µ–Ω—å = 2,016 —Ç–æ—á–µ–∫) ‚úì
R:W Ratio:       step=1m (7 –¥–Ω–µ–π √ó 1,440 —Ç–æ—á–µ–∫/–¥–µ–Ω—å = 10,080 —Ç–æ—á–µ–∫) ‚úì
```

#### –ü—Ä–∏–º–µ—Ä 2: –ú–∞—Å—Å–∏–≤ —Å –¥–ª–∏–Ω–Ω—ã–º –ø–µ—Ä–∏–æ–¥–æ–º –¥–∞–Ω–Ω—ã—Ö

```
Reference –ø–µ—Ä–∏–æ–¥: ¬±90 –¥–Ω–µ–π (180 –¥–Ω–µ–π)
–†–µ–∞–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥:  2025-07-15 - 2025-10-16 (93 –¥–Ω—è)

Bucket analysis: step=10m (93 –¥–Ω—è √ó 144 —Ç–æ—á–µ–∫/–¥–µ–Ω—å = 13,392 —Ç–æ—á–µ–∫) ‚úì
R:W Ratio:       step=5m (93 –¥–Ω—è √ó 288 —Ç–æ—á–µ–∫/–¥–µ–Ω—å = 26,784 —Ç–æ—á–µ–∫) ‚úì
```

#### –ü—Ä–∏–º–µ—Ä 3: –ú–∞—Å—Å–∏–≤ —Å —á–∞—Å—Ç–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

```
Reference –ø–µ—Ä–∏–æ–¥: ¬±90 –¥–Ω–µ–π (180 –¥–Ω–µ–π)
–†–µ–∞–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥:  2025-09-22 - 2025-10-23 (31 –¥–µ–Ω—å)

Bucket analysis: step=10m (31 –¥–µ–Ω—å √ó 144 —Ç–æ—á–µ–∫/–¥–µ–Ω—å = 4,464 —Ç–æ—á–µ–∫) ‚úì
R:W Ratio:       step=5m (31 –¥–µ–Ω—å √ó 288 —Ç–æ—á–µ–∫/–¥–µ–Ω—å = 8,928 —Ç–æ—á–µ–∫) ‚úì
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- ‚úÖ **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –¥–∞–Ω–Ω—ã—Ö**: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ—Å—å –Ω–∞–π–¥–µ–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞—Å—Å–∏–≤–∞
- ‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–æ–∫ 422**: –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π step –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Ä–∞–∑—É–º–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫
- ‚úÖ **–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥**: –∫–∞–∂–¥—ã–π –º–∞—Å—Å–∏–≤ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º step
- ‚úÖ **–°–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ VM**: –º–µ–Ω—å—à–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –æ–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å**: –≤ –ª–æ–≥–∞—Ö –≤–∏–¥–Ω–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–π period –∏ step –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞—Å—Å–∏–≤–∞

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ –≤ –ª–æ–≥–∞—Ö –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è:

```
INFO: SN 2102352VUV10L6000008: Data available from 2025-09-14 to 2025-10-15
INFO: SN 2102352VUV10L6000008: Using period 31.0 days with step=10m
```

–î–ª—è R:W Ratio –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:

```
SN 2102352VUV10L6000008: 31.0 days, using step=5m
```

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

**–§–∞–π–ª—ã —Å –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π –ª–æ–≥–∏–∫–æ–π**:
- `victoriametrics_client.py` - –º–µ—Ç–æ–¥ `find_real_data_period()`
- `analysis/bucket_analysis.py` - –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä 5m/10m
- `analysis/advanced_metrics.py` - –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä 5m/10m
- `analysis/analyze_peak_load.py` - –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä 5m/10m
- `analysis/analyze_rw_ratio.py` - –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä 1m/5m

---

## –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä –ø–µ—Ä–∏–æ–¥–∞ (v1.2.29)

### –ü—Ä–æ–±–ª–µ–º–∞

–í –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –≤–µ—Ä—Å–∏—è—Ö, –µ—Å–ª–∏ –≤ —Ä–∞—Å—á–µ—Ç–Ω–æ–º –ø–µ—Ä–∏–æ–¥–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 2025-09-22 - 2025-09-28) –Ω–µ –±—ã–ª–æ –¥–∞–Ω–Ω—ã—Ö –≤ VictoriaMetrics, Performance —Å–µ–∫—Ü–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –≤ –æ—Ç—á–µ—Ç–µ, –¥–∞–∂–µ –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –¥—Ä—É–≥–∏–µ –ø–µ—Ä–∏–æ–¥—ã.

### –†–µ—à–µ–Ω–∏–µ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –º–µ—Ö–∞–Ω–∏–∑–º **–∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –¥–∞–Ω–Ω—ã—Ö** –≤ –º–µ—Ç–æ–¥–µ `find_available_data_range()`:

#### –ê–ª–≥–æ—Ä–∏—Ç–º

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞**: –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ä–∞—Å—á–µ—Ç–Ω—ã–π –ø–µ—Ä–∏–æ–¥ (–ø–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–ª–Ω–∞—è –Ω–µ–¥–µ–ª—è)
2. **–ü–æ–∏—Å–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**: –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç, –∏—â–µ—Ç—Å—è –±–ª–∏–∂–∞–π—à–∏–π –∫ –¥–∞—Ç–µ –ª–æ–≥–æ–≤ –ø–µ—Ä–∏–æ–¥ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ ¬±6 –º–µ—Å—è—Ü–µ–≤
3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**: –ë–µ—Ä–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω—è—è —Ç–æ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –¥–æ 7 –¥–Ω–µ–π –Ω–∞–∑–∞–¥ (–∏–ª–∏ —Å–∫–æ–ª—å–∫–æ –µ—Å—Ç—å)

```python
def find_available_data_range(serial_number, preferred_start, preferred_end, 
                              reference_date, lookback_days=180):
    """
    1. –ü—Ä–æ–≤–µ—Ä—è–µ–º preferred_start - preferred_end
    2. –ï—Å–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö, –∏—â–µ–º –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ reference_date ¬± lookback_days
    3. –ë–µ—Ä–µ–º –ü–û–°–õ–ï–î–ù–Æ–Æ —Ç–æ—á–∫—É –∏ –¥–æ 7 –¥–Ω–µ–π –Ω–∞–∑–∞–¥ (–∏–ª–∏ —Å–∫–æ–ª—å–∫–æ –¥–æ—Å—Ç—É–ø–Ω–æ)
    
    Returns: (actual_start, actual_end, actual_days)
    """
```

#### –ü—Ä–∏–º–µ—Ä 4: –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä –ø–µ—Ä–∏–æ–¥–∞

```
–î–∞—Ç–∞ –ª–æ–≥–æ–≤:             2025-10-01
–†–∞—Å—á–µ—Ç–Ω—ã–π –ø–µ—Ä–∏–æ–¥:       2025-09-22 - 2025-09-28 (–ù–ï–¢ –î–ê–ù–ù–´–•)

–ü–æ–∏—Å–∫ –¥–∞–Ω–Ω—ã—Ö:           2025-04-01 - 2025-10-31 (¬±6 –º–µ—Å—è—Ü–µ–≤)
–ù–∞–π–¥–µ–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω:     2025-10-10 - 2025-10-14 (4.4 –¥–Ω—è)

–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –ø–µ—Ä–∏–æ–¥:    2025-10-10 - 2025-10-14 ‚úì
Performance —Å–µ–∫—Ü–∏—è:     –ü–†–ò–°–£–¢–°–¢–í–£–ï–¢ —Å 30 –º–µ—Ç—Ä–∏–∫–∞–º–∏
```

### –õ–æ–≥–∏ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞

```
INFO: Preferred performance metrics period: 2025-09-22 - 2025-09-28
INFO: No data in preferred period, searching for available data for SN 2102352VUV10L9000003...
INFO: Found data range: 2025-10-10 - 2025-10-14
INFO: Adjusted period for SN 2102352VUV10L9000003: 2025-10-10 - 2025-10-14 (4.4 days)
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- ‚úÖ **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ**: Performance —Å–µ–∫—Ü–∏—è –ø–æ—è–≤–ª—è–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –º–∞—Å—Å–∏–≤–æ–≤ —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ VM
- ‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å**: –†–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –¥–Ω–µ–π (–æ—Ç 1 –¥–æ 7)
- ‚úÖ **–†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å**: –í—ã–±–∏—Ä–∞–µ—Ç –ø–µ—Ä–∏–æ–¥ –±–ª–∏–∂–∞–π—à–∏–π –∫ –¥–∞—Ç–µ –ª–æ–≥–æ–≤
- ‚úÖ **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å**: –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞

---

## –ü–æ–ª—É—á–∞–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏

### 1. Bandwidth (MB/s)

**–§–æ—Ä–º—É–ª–∞**: `Read Bandwidth + Write Bandwidth`

- **Max**: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∑–∞ –ø–µ—Ä–∏–æ–¥ –ø–æ –≤—Å–µ–º –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞–º
- **Median**: –ú–µ–¥–∏–∞–Ω–Ω–∞—è –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∑–∞ –ø–µ—Ä–∏–æ–¥

**PromQL queries**:
```promql
# Max
max(
    max_over_time(huawei_read_bandwidth_mb_s{SN="...",Resource="Controller"}[7d]) +
    max_over_time(huawei_write_bandwidth_mb_s{SN="...",Resource="Controller"}[7d])
)

# Median
max(
    quantile_over_time(0.5, huawei_read_bandwidth_mb_s{SN="...",Resource="Controller"}[7d]) +
    quantile_over_time(0.5, huawei_write_bandwidth_mb_s{SN="...",Resource="Controller"}[7d])
)
```

### 2. Latency (–º—Å)

**–í–ê–ñ–ù–û**: –ú–µ—Ç—Ä–∏–∫–∏ –≤ VM —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥–∞—Ö (Œºs), –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã (ms)

- **Read Max**: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ –Ω–∞ —á—Ç–µ–Ω–∏–µ
- **Read Median**: –ú–µ–¥–∏–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ –Ω–∞ —á—Ç–µ–Ω–∏–µ
- **Write Max**: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ –Ω–∞ –∑–∞–ø–∏—Å—å
- **Write Median**: –ú–µ–¥–∏–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ –Ω–∞ –∑–∞–ø–∏—Å—å

**PromQL query example**:
```promql
# Read Max (–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è us ‚Üí ms)
max(max_over_time(huawei_avg_read_i_o_response_timeus{SN="...",Resource="Controller"}[7d])) / 1000
```

### 3. CPU (%)

- **Max**: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —É—Ç–∏–ª–∏–∑–∞—Ü–∏—è CPU –∑–∞ –ø–µ—Ä–∏–æ–¥
- **Median**: –ú–µ–¥–∏–∞–Ω–Ω–∞—è —É—Ç–∏–ª–∏–∑–∞—Ü–∏—è CPU –∑–∞ –ø–µ—Ä–∏–æ–¥

**PromQL queries**:
```promql
# Max
max(max_over_time(huawei_avg_cpu_usage_percent{SN="...",Resource="Controller"}[7d]))

# Median
max(quantile_over_time(0.5, huawei_avg_cpu_usage_percent{SN="...",Resource="Controller"}[7d]))
```

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### PERFORMANCE_THRESHOLDS –≤ data_mapping.py

–ü–æ—Ä–æ–≥–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏ –º–∞—Å—Å–∏–≤–∞:

```python
PERFORMANCE_THRESHOLDS = {
    "OceanStor Dorado 5000 V6": {
        # Bandwidth –ø–æ—Ä–æ–≥–∏ (MB/s)
        "bandwidth_max_warning_per_controller": 2560,     # 2.5 GB/s
        "bandwidth_max_critical_per_controller": 3328,    # 3.25 GB/s
        "bandwidth_median_warning_per_controller": 1024,  # 1 GB/s
        "bandwidth_median_critical_per_controller": 1331, # 1.3 GB/s
        
        # Latency –ø–æ—Ä–æ–≥–∏ (ms)
        "latency_write_max_warning": 0.278,
        "latency_write_max_critical": 0.3614,
        "latency_read_max_warning": 3.4,
        "latency_read_max_critical": 4.42,
        
        # CPU –ø–æ—Ä–æ–≥–∏ (%)
        "cpu_max_warning": 31,
        "cpu_max_critical": 40.3,
        "cpu_median_warning": 9,
        "cpu_median_critical": 11.7,
    },
    
    "OceanStor Dorado 8000 V6": {
        # ... –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –ø–æ—Ä–æ–≥–∏ –¥–ª—è 8000 V6
    },
    
    "_default": {
        # ... –ø–æ—Ä–æ–≥–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
    }
}
```

### PERFORMANCE_ANALYSIS_CONFIG

```python
PERFORMANCE_ANALYSIS_CONFIG = {
    "vm_url": "http://localhost:8428",        # VictoriaMetrics URL
    "default_period": "last_full_week",       # –ü–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–ª–Ω–∞—è –Ω–µ–¥–µ–ª—è (–ø–Ω-–≤—Å)
    "custom_period_days": 7,                  # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ø–æ—Å–ª–µ–¥–Ω–∏–µ N –¥–Ω–µ–π
    "timeout_seconds": 30,                    # –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ VM
    
    "descriptions": {
        "bandwidth_spike": "–í—Å–ø–ª–µ—Å–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏",
        "bandwidth_spike_recovery": "–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –≤—Å–ø–ª–µ—Å–∫–∏...",
        "latency_spike": "–í—Å–ø–ª–µ—Å–∫–∏ –∑–∞–¥–µ—Ä–∂–∫–∏",
        "latency_spike_recovery": "–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –≤—Å–ø–ª–µ—Å–∫–∏...",
        "threshold_exceeded": "–ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ø–æ—Ä–æ–≥–∞",
        "threshold_exceeded_recovery": "–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É...",
    }
}
```

---

## –§–æ—Ä–º–∞—Ç –æ—Ç—á—ë—Ç–∞ Excel

### –ö–æ–ª–æ–Ω–∫–∏

```
| Product Model | SN | System Name | Parent Item | Item | Item2 | Prev Value | Value | 30% | Result | Description | Recovery |
```

### –ü—Ä–∏–º–µ—Ä—ã —Å—Ç—Ä–æ–∫

```
Performance | Week: 2025-09-22 - 2025-09-28 | Bandwidth Max (per Controller), MB/s |  | 1387 | 1803 | Passed |  | 

Performance | Week: 2025-09-22 - 2025-09-28 | CPU Max, % |  | 99% | 128% | Not Passed | –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ø–æ—Ä–æ–≥–∞ | –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å...
```

### –õ–æ–≥–∏–∫–∞ Result (–æ–±–Ω–æ–≤–ª–µ–Ω–æ –≤ v1.2.29)

#### 5 —É—Ä–æ–≤–Ω–µ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

```python
# –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–æ–≥–Ω–æ–∑: Value + 30%
forecast_value = current_value * 1.3

# –ü—Ä–æ–≤–µ—Ä—è–µ–º 5 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
if current_value >= critical_threshold:
    result = "Not Passed"
    status = "critical"
    description = "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ø–æ—Ä–æ–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"
    
elif forecast_value >= critical_threshold:
    result = "Not Passed"
    status = "forecast_critical"
    description = "–ü—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ 30% –≤–æ–∑–º–æ–∂–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã"
    
elif current_value >= warning_threshold:
    result = "Not Passed"
    status = "warning"
    description = "–ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ø–æ—Ä–æ–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"
    
elif forecast_value >= warning_threshold:
    result = "Not Passed"
    status = "forecast_warning"
    description = "–ü—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ 30% –≤–æ–∑–º–æ–∂–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã"
    
else:
    result = "Passed"
    status = "passed"
    description = ""
```

#### –ü—Ä–∏–º–µ—Ä—ã —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π

```
–ü—Ä–∏–º–µ—Ä 1: –¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –Ω–æ—Ä–º–µ, –ø—Ä–æ–≥–Ω–æ–∑ –ø—Ä–µ–≤—ã—à–∞–µ—Ç warning
  Value: 1239 MB/s
  30%:   1611 MB/s
  Warning threshold: 1584 MB/s
  Critical threshold: 1980 MB/s
  
  Result: Not Passed
  Description: "–ü—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ 30% –≤–æ–∑–º–æ–∂–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é —á—Ç–µ–Ω–∏—è"
  Recovery: "–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Ä–æ—Å—Ç –Ω–∞–≥—Ä—É–∑–∫–∏"

–ü—Ä–∏–º–µ—Ä 2: –¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç critical
  Value: 2405 MB/s
  30%:   3126 MB/s  
  Warning threshold: 1584 MB/s
  Critical threshold: 1980 MB/s
  
  Result: Not Passed
  Description: "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ø–æ—Ä–æ–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–ø–∏—Å–∏"
  Recovery: "–¢—Ä–µ–±—É–µ—Ç—Å—è —Å—Ä–æ—á–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏ –∏–ª–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã"
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- ‚úÖ –ü–æ–Ω—è—Ç–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –≤–º–µ—Å—Ç–æ –æ–±—â–∏—Ö "–í—Å–ø–ª–µ—Å–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏"
- ‚úÖ –†–∞–∑–ª–∏—á–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π —Å–µ—Ä—å–µ–∑–Ω–æ—Å—Ç–∏
- ‚úÖ –ü—Ä–æ–∑—Ä–∞—á–Ω–∞—è –ª–æ–≥–∏–∫–∞: —Ç–µ–∫—É—â–µ–µ vs –ø—Ä–æ–≥–Ω–æ–∑

---

## API Reference

### VictoriaMetricsClient

#### `__init__(vm_url: str = "http://localhost:8428")`

–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞.

**Parameters:**
- `vm_url`: URL VictoriaMetrics —Å–µ—Ä–≤–µ—Ä–∞

#### `check_availability() -> bool`

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å VictoriaMetrics —á–µ—Ä–µ–∑ `/health` endpoint.

**Returns:** `True` –µ—Å–ª–∏ VM –¥–æ—Å—Ç—É–ø–Ω–∞

#### `get_time_range_last_full_week(reference_date: Optional[datetime] = None) -> Tuple[int, int]`

–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø–æ–ª–Ω–æ–π –Ω–µ–¥–µ–ª–∏ (–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫-–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ).

**Parameters:**
- `reference_date`: –†–µ—Ñ–µ—Ä–µ–Ω—Å–Ω–∞—è –¥–∞—Ç–∞ (default: —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞)

**Returns:** `(start_timestamp, end_timestamp)` –≤ Unix time (—Å–µ–∫—É–Ω–¥—ã)

**Example:**
```python
client = VictoriaMetricsClient()
reference = datetime(2025, 10, 2)  # –°—Ä–µ–¥–∞
start, end = client.get_time_range_last_full_week(reference)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: 2025-09-22 00:00:00 - 2025-09-28 23:59:59
```

#### `get_last_datapoint_time(serial_number: str) -> Optional[int]`

–ü–æ–ª—É—á–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—É—é –º–µ—Ç–∫—É –ø–æ—Å–ª–µ–¥–Ω–µ–π –¥–æ—Å—Ç—É–ø–Ω–æ–π —Ç–æ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –º–∞—Å—Å–∏–≤–∞.

**Parameters:**
- `serial_number`: –°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä –º–∞—Å—Å–∏–≤–∞

**Returns:** Unix timestamp –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ç–æ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ `None` –µ—Å–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö

**Implementation:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `query_range` –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ç–æ—á–∫–∏ –∑–∞ 6 –º–µ—Å—è—Ü–µ–≤
- –ò—â–µ—Ç –ø–æ –º–µ—Ç—Ä–∏–∫–µ `huawei_avg_cpu_usage_percent` (–µ—Å—Ç—å —É –≤—Å–µ—Ö –º–∞—Å—Å–∏–≤–æ–≤)
- –®–∞–≥: 1 –¥–µ–Ω—å (–¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞)

#### `get_all_performance_stats(serial_number: str, reference_date: Optional[datetime] = None, start_time: Optional[int] = None, end_time: Optional[int] = None) -> Dict[str, Any]`

–ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ performance —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–ª—è –º–∞—Å—Å–∏–≤–∞.

**Parameters:**
- `serial_number`: –°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä –º–∞—Å—Å–∏–≤–∞
- `reference_date`: –î–∞—Ç–∞ —Å–±–æ—Ä–∞ –ª–æ–≥–æ–≤ (–¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–µ—Ä–∏–æ–¥–∞ –∞–Ω–∞–ª–∏–∑–∞)
- `start_time`: –ù–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ (Unix timestamp), –µ—Å–ª–∏ `None` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è
- `end_time`: –ö–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞ (Unix timestamp), –µ—Å–ª–∏ `None` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è

**Returns:** Dict —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∏–ª–∏ `{'available': False}` –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç

**Example response:**
```python
{
    'available': True,
    'period_start': '2025-09-22',
    'period_end': '2025-09-28',
    'bandwidth_max_per_controller': 1387.0,      # MB/s
    'bandwidth_median_per_controller': 7.0,      # MB/s
    'latency_read_max': 0.887,                   # ms
    'latency_read_median': 0.5,                  # ms
    'latency_write_max': 1.197,                  # ms
    'latency_write_median': 0.8,                 # ms
    'cpu_max': 99.0,                             # %
    'cpu_median': 25.0                           # %
}
```

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –í log_parser.py

```python
def get_performance_metrics(self) -> Dict[str, Any]:
    """–ü–æ–ª—É—á–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏–∑ VictoriaMetrics"""
    from victoriametrics_client import VictoriaMetricsClient
    from data_mapping import PERFORMANCE_ANALYSIS_CONFIG
    
    # –ü–æ–ª—É—á–∞–µ–º —Å–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä –∏ –¥–∞—Ç—É –ª–æ–≥–æ–≤
    basic_info = self.parse_basic_info()
    serial_number = basic_info.get("Product Serial Number", "")
    log_date_str = basic_info.get("Date", "")
    
    # –ü–∞—Ä—Å–∏–º –¥–∞—Ç—É –ª–æ–≥–æ–≤
    reference_date = None
    if log_date_str:
        try:
            reference_date = datetime.strptime(log_date_str.split()[0], "%Y-%m-%d")
        except Exception as e:
            logger.warning(f"Failed to parse log date: {e}")
    
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∏–µ–Ω—Ç –∏ –ø–æ–ª—É—á–∞–µ–º –º–µ—Ç—Ä–∏–∫–∏
    vm_url = PERFORMANCE_ANALYSIS_CONFIG.get("vm_url", "http://localhost:8428")
    client = VictoriaMetricsClient(vm_url=vm_url)
    
    if not client.check_availability():
        logger.info("VictoriaMetrics is not available")
        return {'available': False}
    
    # VM Client –≤—ã–±–µ—Ä–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
    stats = client.get_all_performance_stats(serial_number, reference_date=reference_date)
    
    return stats
```

### –í excel_generator.py

```python
def _add_performance_checks(self):
    """–î–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏–∑ VictoriaMetrics"""
    from data_mapping import PERFORMANCE_THRESHOLDS, PERFORMANCE_ANALYSIS_CONFIG
    
    performance_data = self.data.get("performance_metrics", {})
    
    if not performance_data.get("available", False):
        return  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–µ–∫—Ü–∏—é –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç
    
    # –ü–æ–ª—É—á–∞–µ–º –ø–æ—Ä–æ–≥–∏ –¥–ª—è –º–æ–¥–µ–ª–∏ –º–∞—Å—Å–∏–≤–∞
    product_model = self.product_model
    thresholds = PERFORMANCE_THRESHOLDS.get(product_model, 
                                            PERFORMANCE_THRESHOLDS.get("_default", {}))
    
    # –ü–æ–ª—É—á–∞–µ–º –ø–µ—Ä–∏–æ–¥
    period_start = performance_data.get("period_start", "N/A")
    period_end = performance_data.get("period_end", "N/A")
    period_info = f"Week: {period_start} - {period_end}"
    
    # Bandwidth Max
    bandwidth_max = performance_data.get("bandwidth_max_per_controller")
    if bandwidth_max is not None:
        warning_threshold = thresholds.get("bandwidth_max_warning_per_controller", 0)
        
        # –ü—Ä–æ–≥–Ω–æ–∑: Value + 30%
        forecast_value = bandwidth_max * 1.3
        
        # Result: —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º –ø—Ä–æ–≥–Ω–æ–∑ —Å –ø–æ—Ä–æ–≥–æ–º
        if forecast_value >= warning_threshold:
            result = "Not Passed"
        else:
            result = "Passed"
        
        self._add_row(
            parent_item="Performance",
            item=period_info,
            item2="Bandwidth Max (per Controller), MB/s",
            value=round(bandwidth_max, 0),
            formula=round(forecast_value, 0),  # 30% column
            result=result,
            ...
        )
```

---

## Graceful Handling

### –°—Ü–µ–Ω–∞—Ä–∏–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –¥–∞–Ω–Ω—ã—Ö

1. **VictoriaMetrics –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞** (`check_availability() == False`):
   - –°–µ–∫—Ü–∏—è Performance –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è
   - –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è: "VictoriaMetrics is not available, skipping performance metrics"

2. **–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–µ—Ä–∏–π–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞**:
   - `get_last_datapoint_time()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `None`
   - Fallback –Ω–∞ –¥–∞—Ç—É –ª–æ–≥–æ–≤ –∏–ª–∏ —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É
   - –ï—Å–ª–∏ –º–µ—Ç—Ä–∏–∫–∏ –≤—Å—ë —Ä–∞–≤–Ω–æ –ø—É—Å—Ç—ã–µ ‚Üí `{'available': False}`

3. **–î–∞—Ç–∞ –ª–æ–≥–æ–≤ –Ω–µ —Ä–∞—Å–ø–∞—Ä—Å–∏–ª–∞—Å—å**:
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω—è—è —Ç–æ—á–∫–∞ –∏–∑ VM
   - –ï—Å–ª–∏ –µ—ë –Ω–µ—Ç ‚Üí fallback –Ω–∞ —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ —Ä–µ—à–µ–Ω–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –¥–ª—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏:

```
INFO: Using log collection date as reference: 2025-10-02
INFO: Fetching performance metrics for SN 2102352VUV10L6000008 from VictoriaMetrics
INFO: Reference date (logs): 2025-10-02
INFO: Last VM data point: 2025-10-16
INFO: Using effective date: 2025-10-02 (min of both)
INFO: Performance metrics period: 2025-09-22 - 2025-09-28
INFO: Performance metrics retrieved successfully for period 2025-09-22 - 2025-09-28
```

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### Python –ø–∞–∫–µ—Ç—ã

- `requests` - –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ VictoriaMetrics API

### VictoriaMetrics

- –í–µ—Ä—Å–∏—è: –ª—é–±–∞—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π `/api/v1/query` –∏ `/api/v1/query_range`
- –ú–µ—Ç—Ä–∏–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ VM —Å labels:
  - `SN` - —Å–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä –º–∞—Å—Å–∏–≤–∞
  - `Resource` - —Ç–∏–ø —Ä–µ—Å—É—Ä—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Controller")

---

## –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

```python
from victoriametrics_client import VictoriaMetricsClient

client = VictoriaMetricsClient()
print(f"VM Available: {client.check_availability()}")
```

### –¢–µ—Å—Ç 2: –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫

```python
from victoriametrics_client import VictoriaMetricsClient
from datetime import datetime

client = VictoriaMetricsClient()
sn = "2102352VUV10L6000008"
log_date = datetime.strptime("2025-10-02", "%Y-%m-%d")

stats = client.get_all_performance_stats(sn, reference_date=log_date)

print(f"Period: {stats.get('period_start')} - {stats.get('period_end')}")
print(f"Bandwidth Max: {stats.get('bandwidth_max_per_controller')} MB/s")
print(f"CPU Max: {stats.get('cpu_max')}%")
```

### –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—á—ë—Ç–∞ –ø–µ—Ä–∏–æ–¥–∞

```python
from victoriametrics_client import VictoriaMetricsClient
from datetime import datetime

client = VictoriaMetricsClient()

# –¢–µ—Å—Ç 1: –°—Ä–µ–¥–∞ 2 –æ–∫—Ç—è–±—Ä—è
reference = datetime(2025, 10, 2)
start, end = client.get_time_range_last_full_week(reference)
print(f"Reference: {reference.strftime('%Y-%m-%d (%A)')}")
print(f"Week: {datetime.fromtimestamp(start)} - {datetime.fromtimestamp(end)}")
# –û–∂–∏–¥–∞–µ—Ç—Å—è: 2025-09-22 (Mon) - 2025-09-28 (Sun)

# –¢–µ—Å—Ç 2: –í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ 28 —Å–µ–Ω—Ç—è–±—Ä—è
reference = datetime(2025, 9, 28)
start, end = client.get_time_range_last_full_week(reference)
print(f"Reference: {reference.strftime('%Y-%m-%d (%A)')}")
print(f"Week: {datetime.fromtimestamp(start)} - {datetime.fromtimestamp(end)}")
# –û–∂–∏–¥–∞–µ—Ç—Å—è: 2025-09-15 (Mon) - 2025-09-21 (Sun) - –ø—Ä–µ–¥—ã–¥—É—â–∞—è –Ω–µ–¥–µ–ª—è
```

---

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **Retention period**: –ò—â–µ—Ç –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤ (180 –¥–Ω–µ–π). –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ä—à–µ - –Ω–µ –Ω–∞–π–¥—ë—Ç.

2. **–ú–µ—Ç—Ä–∏–∫–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `huawei_avg_cpu_usage_percent` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ç–æ—á–∫–∏. –ï—Å–ª–∏ —Ç–æ–ª—å–∫–æ —ç—Ç–∞ –º–µ—Ç—Ä–∏–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç - –±—É–¥–µ—Ç fallback.

3. **–®–∞–≥ query_range**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —à–∞–≥ 1 –¥–µ–Ω—å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ç–æ—á–∫–∏. –ú–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ –ø–æ—Å–ª–µ–¥–Ω—è—è —Ç–æ—á–∫–∞ –≤–Ω—É—Ç—Ä–∏ –¥–Ω—è.

4. **Aggregate –ø–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞–º**: –ë–µ—Ä—ë—Ç—Å—è `max()` –∏–∑ –≤—Å–µ—Ö –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤. –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –¥—Ä—É–≥–∞—è –ª–æ–≥–∏–∫–∞ (—Å—Ä–µ–¥–Ω–µ–µ, —Å—É–º–º–∞) - —Ç—Ä–µ–±—É–µ—Ç—Å—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è.

---

## üîß –ü—Ä–∏–º–µ—Ä—ã curl –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ VictoriaMetrics API

### –ë–∞–∑–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

```bash
VM_URL="http://localhost:8428"
START_TIME=1571875200  # Unix timestamp –Ω–∞—á–∞–ª–∞ –ø–µ—Ä–∏–æ–¥–∞
END_TIME=1763700000    # Unix timestamp –∫–æ–Ω—Ü–∞ –ø–µ—Ä–∏–æ–¥–∞
TEST_SN="2102352VUV10L6000008"  # –¢–µ—Å—Ç–æ–≤—ã–π —Å–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä
```

**–í–∞–∂–Ω–æ:** VictoriaMetrics —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ URL-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ PromQL —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ `match[]`.

---

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ VictoriaMetrics

**–ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ health endpoint:**

```bash
curl -s "http://localhost:8428/health"
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º HTTP 200

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å –∫–æ–¥–æ–º –æ—Ç–≤–µ—Ç–∞:**

```bash
STATUS=$(curl -s -o /dev/null -w "%{http_code}" "http://localhost:8428/health")
if [ "$STATUS" == "200" ]; then
    echo "‚úÖ VictoriaMetrics –¥–æ—Å—Ç—É–ø–Ω–∞"
else
    echo "‚ùå VictoriaMetrics –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ (HTTP $STATUS)"
fi
```

---

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–µ—Ä–∏–π–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤ (SN)

**–ó–∞–ø—Ä–æ—Å:**

```bash
curl -s "http://localhost:8428/api/v1/label/SN/values?start=${START_TIME}&end=${END_TIME}" | jq -r '.data[]'
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

```
2102352VUV10L6000008
2102352VUV10L6000009
2102352VUV10L6000010
...
```

**–ü–æ–¥—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ SN:**

```bash
curl -s "http://localhost:8428/api/v1/label/SN/values?start=${START_TIME}&end=${END_TIME}" | jq -r '.data | length'
# –†–µ–∑—É–ª—å—Ç–∞—Ç: 56
```

---

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ SN

**–ó–∞–ø—Ä–æ—Å (—Å URL encoding):**

```bash
# –í–∞—Ä–∏–∞–Ω—Ç 1: –° —è–≤–Ω—ã–º URL encoding
curl -s "http://localhost:8428/api/v1/label/Resource/values?match%5B%5D=%7BSN%3D%22${TEST_SN}%22%7D&start=${START_TIME}&end=${END_TIME}" | jq -r '.data[]'

# –í–∞—Ä–∏–∞–Ω—Ç 2: Bash –¥–µ–ª–∞–µ—Ç encoding –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
curl -s --data-urlencode "match[]={SN=\"${TEST_SN}\"}" \
    "http://localhost:8428/api/v1/label/Resource/values?start=${START_TIME}&end=${END_TIME}" | jq -r '.data[]'
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

```
Controller
Disk
FC Port
LUN
Storage Pool
...
```

**–ü–æ—è—Å–Ω–µ–Ω–∏–µ:** `match[]={SN="2102352VUV10L6000008"}` —ç—Ç–æ PromQL —Å–µ–ª–µ–∫—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω.

---

### 4. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –º–µ—Ç—Ä–∏–∫ –¥–ª—è —Ä–µ—Å—É—Ä—Å–∞

**–ó–∞–ø—Ä–æ—Å –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫ –¥–ª—è Controller:**

```bash
curl -s "http://localhost:8428/api/v1/series?match%5B%5D=%7BSN%3D%22${TEST_SN}%22%2CResource%3D%22Controller%22%7D&start=${START_TIME}&end=${END_TIME}" | \
    jq -r '.data[].__name__' | sort -u
```

**–ü–æ–∏—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, ratio):**

```bash
curl -s "http://localhost:8428/api/v1/series?match%5B%5D=%7BSN%3D%22${TEST_SN}%22%2CResource%3D%22Controller%22%7D&start=${START_TIME}&end=${END_TIME}" | \
    jq -r '.data[].__name__' | grep -i ratio
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

```
huawei_ratio_of_read_i_os_to_total_i_os_percent
huawei_ratio_of_write_i_os_to_total_i_os_percent
huawei_cache_flushes_to_write_requests_ratio_percent
huawei_hit_ratio_percent
huawei_read_cache_hit_ratio_percent
...
```

---

### 5. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ Elements (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è FC Port)

**–ó–∞–ø—Ä–æ—Å:**

```bash
curl -s "http://localhost:8428/api/v1/label/Element/values?match%5B%5D=%7BSN%3D%22${TEST_SN}%22%2CResource%3D%22FC%20Port%22%7D&start=${START_TIME}&end=${END_TIME}" | \
    jq -r '.data[]'
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

```
CTE0.A.IOM0.P0
CTE0.A.IOM0.P1
CTE0.B.IOM1.P0
CTE0.B.IOM1.P1
...
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ü—Ä–æ–±–µ–ª –≤ "FC Port" –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ `%20`.

---

### 6. –ó–∞–ø—Ä–æ—Å —Ç–µ–∫—É—â–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫–∏ (query)

**–ó–∞–ø—Ä–æ—Å bandwidth read –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –º–æ–º–µ–Ω—Ç–∞:**

```bash
CURRENT_TIME=$(date +%s)
curl -s "http://localhost:8428/api/v1/query?query=huawei_read_bandwidth_mb_s%7BSN%3D%22${TEST_SN}%22%2CResource%3D%22Controller%22%7D&time=${CURRENT_TIME}" | \
    jq '.data.result[0]'
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

```json
{
  "metric": {
    "__name__": "huawei_read_bandwidth_mb_s",
    "Element": "CTE0.A",
    "Resource": "Controller",
    "SN": "2102352VUV10L6000008",
    "scrape_interval": "60"
  },
  "value": [
    1763646411,
    "245"
  ]
}
```

–ì–¥–µ:
- `value[0]` - Unix timestamp
- `value[1]` - –∑–Ω–∞—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ (—Å—Ç—Ä–æ–∫–∞)

---

### 7. –ó–∞–ø—Ä–æ—Å –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –∑–Ω–∞—á–µ–Ω–∏–π (query_range)

**–ó–∞–ø—Ä–æ—Å R:W Ratio –∑–∞ –≤–µ—Å—å –ø–µ—Ä–∏–æ–¥:**

```bash
curl -s "http://localhost:8428/api/v1/query_range?query=huawei_ratio_of_read_i_os_to_total_i_os_percent%7BSN%3D%22${TEST_SN}%22%2CResource%3D%22Controller%22%7D&start=${START_TIME}&end=${END_TIME}&step=1d" | \
    jq '.data.result[0] | {metric: .metric.Element, first: .values[0], last: .values[-1], total_points: (.values | length)}'
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

```json
{
  "metric": "CTE0.A",
  "first": [1755869874, "44.0"],
  "last": [1763645874, "45.2"],
  "total_points": 89
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `query` - PromQL –∑–∞–ø—Ä–æ—Å (URL-encoded)
- `start` - –Ω–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ (Unix timestamp)
- `end` - –∫–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞ (Unix timestamp)
- `step` - —à–∞–≥ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ (`5m`, `1h`, `1d`, –∏ —Ç.–¥.)

---

### 8. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è R:W Ratio Analysis

**–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ ratio –¥–ª—è Controller:**

```bash
curl -s "http://localhost:8428/api/v1/series?match%5B%5D=%7BSN%3D%22${TEST_SN}%22%2CResource%3D%22Controller%22%7D&start=${START_TIME}&end=${END_TIME}" | \
    jq -r '.data[].__name__' | grep -E 'ratio.*read|ratio.*write'
```

**–ü–æ–ª—É—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è Read I/O –ø—Ä–æ—Ü–µ–Ω—Ç–∞:**

```bash
curl -s "http://localhost:8428/api/v1/query_range?query=huawei_ratio_of_read_i_os_to_total_i_os_percent%7BSN%3D%22${TEST_SN}%22%2CResource%3D%22Controller%22%7D&start=${START_TIME}&end=${END_TIME}&step=5m" | \
    jq '.data.result[0].values | map(.[1] | tonumber) | {min: min, max: max, median: (sort | .[length/2 | floor])}'
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

```json
{
  "min": 1.0,
  "max": 99.5,
  "median": 44.0
}
```

---

### 9. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –º–∞—Å—Å–∏–≤–∞

**–£–∑–Ω–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞–Ω–Ω—ã—Ö:**

```bash
curl -s "http://localhost:8428/api/v1/query_range?query=huawei_avg_cpu_usage_percent%7BSN%3D%22${TEST_SN}%22%2CResource%3D%22Controller%22%7D&start=${START_TIME}&end=${END_TIME}&step=1d" | \
    jq '.data.result[0] | if .values then {first_date: (.values[0][0] | todate), last_date: (.values[-1][0] | todate)} else "No data" end'
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

```json
{
  "first_date": "2025-08-22T00:00:00Z",
  "last_date": "2025-11-20T00:00:00Z"
}
```

---

### 10. –£–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏)

**‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï:** –≠—Ç–∞ –æ–ø–µ—Ä–∞—Ü–∏—è –Ω–µ–æ–±—Ä–∞—Ç–∏–º–∞!

**–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ SN:**

```bash
curl -X POST "http://localhost:8428/api/v1/admin/tsdb/delete_series?match%5B%5D=%7BSN%3D%22${TEST_SN}%22%7D"
```

**–£–¥–∞–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–µ—Ä–∏–æ–¥:**

```bash
curl -X POST "http://localhost:8428/api/v1/admin/tsdb/delete_series?match%5B%5D=%7BSN%3D%22${TEST_SN}%22%7D&start=${START_TIME}&end=${END_TIME}"
```

---

### URL Encoding Reference

–î–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω—É–∂–Ω–æ –∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã:

| –°–∏–º–≤–æ–ª | URL-encoded | –ü—Ä–∏–º–µ—Ä                              |
|--------|-------------|-------------------------------------|
| `[`    | `%5B`       | `match[]` ‚Üí `match%5B%5D`          |
| `]`    | `%5D`       |                                     |
| `{`    | `%7B`       | `{SN="..."` ‚Üí `%7BSN%3D%22...`    |
| `}`    | `%7D`       |                                     |
| `"`    | `%22`       | `"value"` ‚Üí `%22value%22`          |
| `=`    | `%3D`       | `SN="..."` ‚Üí `SN%3D%22...`        |
| `,`    | `%2C`       | `SN="...",Resource="..."` ‚Üí `...%2CResource...` |
| ` ` (–ø—Ä–æ–±–µ–ª) | `%20` | `FC Port` ‚Üí `FC%20Port`            |

**–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä PromQL —Å–µ–ª–µ–∫—Ç–æ—Ä–∞:**

- **–û—Ä–∏–≥–∏–Ω–∞–ª:** `{SN="2102352VUV10L6000008",Resource="Controller"}`
- **–ó–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–æ:** `%7BSN%3D%222102352VUV10L6000008%22%2CResource%3D%22Controller%22%7D`

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `--data-urlencode` –≤ curl:

```bash
curl -G --data-urlencode 'match[]={SN="2102352VUV10L6000008",Resource="Controller"}' \
    "http://localhost:8428/api/v1/series?start=${START_TIME}&end=${END_TIME}"
```

---

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

**1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∫–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è SN:**

```bash
SN_COUNT=$(curl -s "http://localhost:8428/api/v1/label/SN/values?start=${START_TIME}&end=${END_TIME}" | jq -r '.data | length')
echo "–í—Å–µ–≥–æ SN –≤ VM: ${SN_COUNT}"
```

**2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∫–∏–µ —Ä–µ—Å—É—Ä—Å—ã –¥–æ—Å—Ç—É–ø–Ω—ã:**

```bash
curl -s "http://localhost:8428/api/v1/label/Resource/values?start=${START_TIME}&end=${END_TIME}" | jq -r '.data[]'
```

**3. –ù–∞–π—Ç–∏ –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ bandwidth:**

```bash
curl -s "http://localhost:8428/api/v1/label/__name__/values?start=${START_TIME}&end=${END_TIME}" | \
    jq -r '.data[]' | grep bandwidth
```

**4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –º–µ—Ç—Ä–∏–∫ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ R:W Ratio:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç—Ä–∏–∫ ratio –¥–ª—è –≤—Å–µ—Ö –º–∞—Å—Å–∏–≤–æ–≤
for SN in $(curl -s "http://localhost:8428/api/v1/label/SN/values?start=${START_TIME}&end=${END_TIME}" | jq -r '.data[]'); do
    HAS_RATIO=$(curl -s "http://localhost:8428/api/v1/series?match%5B%5D=%7BSN%3D%22${SN}%22%2CResource%3D%22Controller%22%7D&start=${START_TIME}&end=${END_TIME}" | \
        jq -r '.data[].__name__' | grep -c 'ratio_of_read_i_os_to_total_i_os_percent' || echo "0")
    echo "${SN}: ${HAS_RATIO} –º–µ—Ç—Ä–∏–∫"
done
```

---

## üìö –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –º–µ—Ç—Ä–∏–∫ –∏ —Ä–µ—Å—É—Ä—Å–æ–≤

### –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–∏–ø—ã —Ä–µ—Å—É—Ä—Å–æ–≤ (Resource)

VictoriaMetrics —Å–æ–¥–µ—Ä–∂–∏—Ç –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö —Ç–∏–ø–æ–≤ —Ä–µ—Å—É—Ä—Å–æ–≤ Huawei:

| –†–µ—Å—É—Ä—Å | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä—ã –º–µ—Ç—Ä–∏–∫ |
|--------|----------|----------------|
| **Controller** | –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –º–∞—Å—Å–∏–≤–∞ | CPU, Cache, Bandwidth, Latency, IOPS |
| **Controller NFSV3/V4/V4.1** | NFS –ø—Ä–æ—Ç–æ–∫–æ–ª—ã | NFS –æ–ø–µ—Ä–∞—Ü–∏–∏, –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å |
| **Controller SMB2/3** | SMB –ø—Ä–æ—Ç–æ–∫–æ–ª | CIFS –æ–ø–µ—Ä–∞—Ü–∏–∏, –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å |
| **Disk** | –§–∏–∑–∏—á–µ—Å–∫–∏–π –¥–∏—Å–∫ | –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, —É—Ç–∏–ª–∏–∑–∞—Ü–∏—è, IOPS |
| **Disk Domain** | –î–æ–º–µ–Ω –¥–∏—Å–∫–æ–≤ | –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–∏—Å–∫–æ–≤ |
| **FC Port** | Fibre Channel –ø–æ—Ä—Ç | Bandwidth, Errors, Link status |
| **Ethernet Port** | Ethernet –ø–æ—Ä—Ç | Bandwidth, Errors, Packets |
| **LUN** | –õ–æ–≥–∏—á–µ—Å–∫–∏–π Unit Number | IOPS, Bandwidth, Latency –ø–æ LUN |
| **Storage Pool** | –ü—É–ª —Ö—Ä–∞–Ω–µ–Ω–∏—è | –ï–º–∫–æ—Å—Ç—å, —É—Ç–∏–ª–∏–∑–∞—Ü–∏—è, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å |
| **Host** | –•–æ—Å—Ç-–∏–Ω–∏—Ü–∏–∞—Ç–æ—Ä | –ú–µ—Ç—Ä–∏–∫–∏ –ø–æ —Ö–æ—Å—Ç–∞–º |
| **Remote Device** | –£–¥–∞–ª–µ–Ω–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ | –†–µ–ø–ª–∏–∫–∞—Ü–∏—è, DR –º–µ—Ç—Ä–∏–∫–∏ |
| **SmartQoS** | QoS –ø–æ–ª–∏—Ç–∏–∫–∏ | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –º–µ—Ç—Ä–∏–∫–∏ QoS |
| **File System** | –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ | NAS –º–µ—Ç—Ä–∏–∫–∏ |

### –ö–ª—é—á–µ–≤—ã–µ –≥—Ä—É–ø–ø—ã –º–µ—Ç—Ä–∏–∫

#### 1. –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (Performance)

**Bandwidth (–ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å):**
```
huawei_read_bandwidth_mb_s          # –ß—Ç–µ–Ω–∏–µ MB/s
huawei_write_bandwidth_mb_s         # –ó–∞–ø–∏—Å—å MB/s
huawei_block_bandwidth_mb_s         # –ë–ª–æ—á–Ω–∞—è –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
huawei_file_bandwidth_kb_s          # –§–∞–π–ª–æ–≤–∞—è –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å (NAS)
huawei_cache_flushing_bandwidth_mb_s # –°–±—Ä–æ—Å –∫–µ—à–∞ –Ω–∞ –¥–∏—Å–∫
```

**Latency (–ó–∞–¥–µ—Ä–∂–∫–∞):**
```
huawei_avg_read_i_o_response_timeus   # –°—Ä–µ–¥–Ω—è—è –∑–∞–¥–µ—Ä–∂–∫–∞ —á—Ç–µ–Ω–∏—è (Œºs)
huawei_avg_write_i_o_response_timeus  # –°—Ä–µ–¥–Ω—è—è –∑–∞–¥–µ—Ä–∂–∫–∞ –∑–∞–ø–∏—Å–∏ (Œºs)
huawei_avg_i_o_response_time_us       # –°—Ä–µ–¥–Ω—è—è –æ–±—â–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
huawei_read_latency_ms                # –ó–∞–¥–µ—Ä–∂–∫–∞ —á—Ç–µ–Ω–∏—è (ms)
huawei_write_latency_ms               # –ó–∞–¥–µ—Ä–∂–∫–∞ –∑–∞–ø–∏—Å–∏ (ms)
```

**IOPS (Operations per second):**
```
huawei_read_i_o_s                     # –û–ø–µ—Ä–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è –≤ —Å–µ–∫—É–Ω–¥—É
huawei_write_i_o_s                    # –û–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞–ø–∏—Å–∏ –≤ —Å–µ–∫—É–Ω–¥—É
huawei_total_i_o_s                    # –û–±—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ —Å–µ–∫—É–Ω–¥—É
huawei_cifs_operation_count_per_second # NAS –æ–ø–µ—Ä–∞—Ü–∏–∏ (CIFS)
huawei_nfs_operation_count_per_second  # NAS –æ–ø–µ—Ä–∞—Ü–∏–∏ (NFS)
```

#### 2. –ú–µ—Ç—Ä–∏–∫–∏ R:W Ratio

**–î–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ—Ñ–∏–ª—è –Ω–∞–≥—Ä—É–∑–∫–∏:**
```
huawei_ratio_of_read_i_os_to_total_i_os_percent   # % Read –æ—Ç –æ–±—â–∏—Ö IOPS
huawei_ratio_of_write_i_os_to_total_i_os_percent  # % Write –æ—Ç –æ–±—â–∏—Ö IOPS
```

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –î–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –≤ `analyze_rw_ratio.py` 
> Write –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∫–∞–∫ `Write = 100 - Read`. –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —á—Ç–æ Read% + Write% = 100% 
> –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ –∏ –∏—Å–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö.

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```bash
# –ü–æ–ª—É—á–∏—Ç—å R:W Ratio –∑–∞ –ø–µ—Ä–∏–æ–¥
curl -s "http://localhost:8428/api/v1/query_range?\
query=huawei_ratio_of_read_i_os_to_total_i_os_percent%7B\
SN%3D%22${TEST_SN}%22%2CResource%3D%22Controller%22%7D\
&start=${START_TIME}&end=${END_TIME}&step=5m"
```

#### 3. –ú–µ—Ç—Ä–∏–∫–∏ —É—Ç–∏–ª–∏–∑–∞—Ü–∏–∏ (Utilization)

**CPU:**
```
huawei_avg_cpu_usage_percent          # –°—Ä–µ–¥–Ω—è—è –∑–∞–≥—Ä—É–∑–∫–∞ CPU (%)
huawei_max_cpu_usage_percent          # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ CPU (%)
huawei_cpu_usage_percent              # –¢–µ–∫—É—â–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ CPU (%)
```

**Cache:**
```
huawei_avg_cache_usage_percent        # –°—Ä–µ–¥–Ω—è—è —É—Ç–∏–ª–∏–∑–∞—Ü–∏—è –∫–µ—à–∞ (%)
huawei_cache_read_usage_percent       # –£—Ç–∏–ª–∏–∑–∞—Ü–∏—è Read –∫–µ—à–∞ (%)
huawei_cache_write_usage_percent      # –£—Ç–∏–ª–∏–∑–∞—Ü–∏—è Write –∫–µ—à–∞ (%)
huawei_cache_page_utilization_percent # –£—Ç–∏–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü –∫–µ—à–∞ (%)
huawei_cache_chunk_utilization_percent # –£—Ç–∏–ª–∏–∑–∞—Ü–∏—è —á–∞–Ω–∫–æ–≤ –∫–µ—à–∞ (%)
```

**–î–∏—Å–∫–∏:**
```
huawei_disk_utilization_percent       # –£—Ç–∏–ª–∏–∑–∞—Ü–∏—è –¥–∏—Å–∫–∞ (%)
huawei_average_utilization_percent    # –°—Ä–µ–¥–Ω—è—è —É—Ç–∏–ª–∏–∑–∞—Ü–∏—è –¥–∏—Å–∫–æ–≤ –≤ –ø—É–ª–µ
```

#### 4. –ú–µ—Ç—Ä–∏–∫–∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ (Reliability)

**Cache Hit Ratio:**
```
huawei_hit_ratio_percent              # –û–±—â–∏–π Hit Ratio –∫–µ—à–∞ (%)
huawei_read_cache_hit_ratio_percent   # Read Hit Ratio (%)
huawei_write_cache_hit_ratio_percent  # Write Hit Ratio (%)
```

**Response Time:**
```
huawei_avg_i_o_sizekb                 # –°—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä I/O (KB)
huawei_avg_read_i_o_sizekb            # –°—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä Read I/O (KB)
huawei_avg_write_i_o_sizekb           # –°—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä Write I/O (KB)
```

#### 5. –ú–µ—Ç—Ä–∏–∫–∏ –ø–æ—Ä—Ç–æ–≤ (FC/Ethernet)

**FC Port:**
```
huawei_fc_port_bandwidth_mb_s         # –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å FC –ø–æ—Ä—Ç–∞
huawei_fc_port_utilization_percent    # –£—Ç–∏–ª–∏–∑–∞—Ü–∏—è FC –ø–æ—Ä—Ç–∞ (%)
huawei_fc_port_rx_bandwidth_mb_s      # RX bandwidth
huawei_fc_port_tx_bandwidth_mb_s      # TX bandwidth
```

**Ethernet Port:**
```
huawei_ethernet_port_bandwidth_mb_s   # –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å Ethernet
huawei_ethernet_port_utilization_percent # –£—Ç–∏–ª–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç–∞ (%)
```

#### 6. –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

**Dedupe/Compression:**
```
huawei_data_reduction_ratio_percent   # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å–∂–∞—Ç–∏—è –¥–∞–Ω–Ω—ã—Ö
huawei_space_saved_by_dedup_compression_gb # –°—ç–∫–æ–Ω–æ–º–ª–µ–Ω–Ω–æ–µ –º–µ—Å—Ç–æ (GB)
```

**SmartQoS:**
```
huawei_smartqos_bandwidth_limit_mb_s  # –õ–∏–º–∏—Ç –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ QoS
huawei_smartqos_iops_limit            # –õ–∏–º–∏—Ç IOPS QoS
```

**Replication:**
```
huawei_replication_bandwidth_mb_s     # Bandwidth —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏
huawei_remote_replication_rto_sec     # RTO (Recovery Time Objective)
huawei_remote_replication_rpo_sec     # RPO (Recovery Point Objective)
```

### –ö–∞–∫ –Ω–∞–π—Ç–∏ –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è —Ç–∏–ø–∞ —Ä–µ—Å—É—Ä—Å–∞

**–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è Controller:**
```bash
curl -s "http://localhost:8428/api/v1/series?\
match%5B%5D=%7BSN%3D%22${TEST_SN}%22%2CResource%3D%22Controller%22%7D\
&start=${START_TIME}&end=${END_TIME}" | \
    jq -r '.data[].__name__' | sort -u
```

**–ü–æ–∏—Å–∫ –º–µ—Ç—Ä–∏–∫ –ø–æ –∫–ª—é—á–µ–≤–æ–º—É —Å–ª–æ–≤—É:**
```bash
# –ù–∞–π—Ç–∏ –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ "bandwidth"
curl -s "http://localhost:8428/api/v1/label/__name__/values?\
start=${START_TIME}&end=${END_TIME}" | \
    jq -r '.data[]' | grep -i bandwidth

# –ù–∞–π—Ç–∏ –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ "latency"
curl -s "http://localhost:8428/api/v1/label/__name__/values?\
start=${START_TIME}&end=${END_TIME}" | \
    jq -r '.data[]' | grep -i latency

# –ù–∞–π—Ç–∏ –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ "ratio"
curl -s "http://localhost:8428/api/v1/label/__name__/values?\
start=${START_TIME}&end=${END_TIME}" | \
    jq -r '.data[]' | grep -i ratio
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–µ—Ç—Ä–∏–∫–∏ (labels)

–ö–∞–∂–¥–∞—è –º–µ—Ç—Ä–∏–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ labels:

| Label | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä –∑–Ω–∞—á–µ–Ω–∏—è |
|-------|----------|-----------------|
| `__name__` | –ò–º—è –º–µ—Ç—Ä–∏–∫–∏ | `huawei_read_bandwidth_mb_s` |
| `SN` | –°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ | `2102352VUV10L6000008` |
| `Resource` | –¢–∏–ø —Ä–µ—Å—É—Ä—Å–∞ | `Controller`, `Disk`, `FC Port` |
| `Element` | –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç | `CTE0.A`, `0.1`, `CTE0.A.IOM0.P0` |
| `scrape_interval` | –ò–Ω—Ç–µ—Ä–≤–∞–ª —Å–±–æ—Ä–∞ (—Å–µ–∫) | `60` |

**–ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–π –º–µ—Ç—Ä–∏–∫–∏:**
```json
{
  "__name__": "huawei_read_bandwidth_mb_s",
  "SN": "2102352VUV10L6000008",
  "Resource": "Controller",
  "Element": "CTE0.A",
  "scrape_interval": "60"
}
```

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–µ—Ç—Ä–∏–∫

**1. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ Controller:**
```bash
# Max Read Bandwidth –∑–∞ –ø–µ—Ä–∏–æ–¥
curl -s "http://localhost:8428/api/v1/query?\
query=max_over_time(huawei_read_bandwidth_mb_s%7B\
SN%3D%22${TEST_SN}%22%2CResource%3D%22Controller%22%7D\
[${PERIOD}])"

# Average CPU –∑–∞ –ø–µ—Ä–∏–æ–¥
curl -s "http://localhost:8428/api/v1/query?\
query=avg_over_time(huawei_avg_cpu_usage_percent%7B\
SN%3D%22${TEST_SN}%22%2CResource%3D%22Controller%22%7D\
[${PERIOD}])"
```

**2. –ê–Ω–∞–ª–∏–∑ —É—Ç–∏–ª–∏–∑–∞—Ü–∏–∏ –¥–∏—Å–∫–æ–≤:**
```bash
curl -s "http://localhost:8428/api/v1/query_range?\
query=huawei_disk_utilization_percent%7B\
SN%3D%22${TEST_SN}%22%2CResource%3D%22Disk%22%7D\
&start=${START_TIME}&end=${END_TIME}&step=5m" | \
    jq '.data.result[] | {disk: .metric.Element, values: .values}'
```

**3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ—Ä—Ç–æ–≤ FC:**
```bash
curl -s "http://localhost:8428/api/v1/query_range?\
query=huawei_fc_port_bandwidth_mb_s%7B\
SN%3D%22${TEST_SN}%22%2CResource%3D%22FC%20Port%22%7D\
&start=${START_TIME}&end=${END_TIME}&step=5m"
```

---

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ VictoriaMetrics –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ –∫–æ–º–∞–Ω–¥–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

