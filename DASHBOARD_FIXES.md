# ๐ง ะัะฟัะฐะฒะปะตะฝะธั ะดะฐัะฑะพัะดะฐ

## ะัะพะฑะปะตะผั ะบะพัะพััะต ะฑัะปะธ ะฝะฐะนะดะตะฝั

### 1. โ ะะตัะตะผะตะฝะฝะฐั $array ะฝะต ัะฐะฑะพัะฐะปะฐ
**ะัะพะฑะปะตะผะฐ**: ะ ะดะฐัะฑะพัะดะต ะธัะฟะพะปัะทะพะฒะฐะปะฐัั ะฟะตัะตะผะตะฝะฝะฐั `$array`, ะฝะพ ะฒ CSV ะดะฐะฝะฝัั ะธัะฟะพะปัะทัะตััั label `SN` (ัะตัะธะนะฝัะน ะฝะพะผะตั ะผะฐััะธะฒะฐ).

**ะะตัะตะฝะธะต**: ะะฐะผะตะฝะธะปะธ `$array` ะฝะฐ `$SN` ะฒะพ ะฒัะตั ะทะฐะฟัะพัะฐั ะธ ะฟะตัะตะผะตะฝะฝัั.

### 2. โ ะััััััะฒะพะฒะฐะปะฐ ัะธะปัััะฐัะธั ะฟะพ ัะธะฟั ัะตััััะฐ
**ะัะพะฑะปะตะผะฐ**: ะ ะฟะตัะตะผะตะฝะฝะพะน `$Element` ะฑัะปะธ ัะผะตัะฐะฝั ะฒัะต ัะปะตะผะตะฝัั ะฒัะตั ัะตััััะพะฒ (ะบะพะฝััะพะปะปะตัั 0A, 0B, LUN, ะดะธัะบะธ, ะฟะพััั).

**ะะตัะตะฝะธะต**: ะะพะฑะฐะฒะธะปะธ ะฟะตัะตะผะตะฝะฝัั `$Resource` ะดะปั ัะธะปัััะฐัะธะธ ะฟะพ ัะธะฟั ัะตััััะฐ ั ะบะฐัะบะฐะดะฝะพะน ัะธะปัััะฐัะธะตะน.

### 3. โ ะะตะฟัะฐะฒะธะปัะฝัะต ะฝะฐะทะฒะฐะฝะธั ะฒ ะทะฐะณะพะปะพะฒะบะฐั
**ะัะพะฑะปะตะผะฐ**: ะ ะทะฐะณะพะปะพะฒะบะฐั ัะตะบัะธะน ะฟะพะบะฐะทัะฒะฐะปะพัั "Unknown_Controller", "Unknown_LUN" ะธ ั.ะด.

**ะะตัะตะฝะธะต**: ะัะฟัะฐะฒะธะปะธ ะผะฐะฟะฟะธะฝะณ ัะตััััะพะฒ - ัะตะฟะตัั ะธัะฟะพะปัะทััััั ะฟัะฐะฒะธะปัะฝัะต ะฝะฐะทะฒะฐะฝะธั "Controller", "LUN", "Disk" ะธ ั.ะด.

## ะงัะพ ะฑัะปะพ ะธัะฟัะฐะฒะปะตะฝะพ

### 1. ะะตัะตะผะตะฝะฝัะต ะดะฐัะฑะพัะดะฐ

#### ะะพ:
```
$array    - label_values(array)           โ ะะต ัะฐะฑะพัะฐะปะพ
$Element  - label_values({array=~"$array"},Element)  โ ะัะต ัะปะตะผะตะฝัั ะฒะฟะตัะตะผะตัะบั
```

#### ะะพัะปะต:
```
$SN       - label_values(SN)              โ ะกะตัะธะนะฝัะน ะฝะพะผะตั ะผะฐััะธะฒะฐ
$Resource - label_values({SN=~"$SN"},Resource)  โ ะขะธะฟ ัะตััััะฐ
$Element  - label_values({SN=~"$SN", Resource=~"$Resource"},Element)  โ ะคะธะปัััะพะฒะฐะฝะฝัะต ัะปะตะผะตะฝัั
```

### 2. ะะฐะฟัะพัั ะฒ ะฟะฐะฝะตะปัั

#### ะะพ:
```promql
huawei_kv_cpu_usage_percent{array=~"$array", Resource="207", Element=~"$Element"}
```

#### ะะพัะปะต:
```promql
huawei_kv_cpu_usage_percent{SN=~"$SN", Resource="Controller", Element=~"$Element"}
```

### 3. ะะฐะทะฒะฐะฝะธั ัะตััััะพะฒ

#### ะะพ:
```python
RESOURCE_MAPPING = {
    "Controller": "Unknown_Controller",  # โ
    "LUN": "Unknown_LUN",                # โ
    ...
}
```

#### ะะพัะปะต:
```python
RESOURCE_MAPPING = {
    "Controller": "Controller",  # โ
    "LUN": "LUN",                # โ
    ...
}
```

## ะะฐะบ ัะฐะฑะพัะฐะตั ะบะฐัะบะฐะดะฝะฐั ัะธะปัััะฐัะธั

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 1. ะัะฑะธัะฐะตัะต SN                     โ
โ    โ 2102353TJWFSP3100020           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 2. ะัะฑะธัะฐะตัะต Resource               โ
โ    โ Controller, LUN, Disk, ...     โ
โ    (ัะพะปัะบะพ ะดะปั ะฒัะฑัะฐะฝะฝะพะณะพ SN)       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 3. ะัะฑะธัะฐะตัะต Element                โ
โ    Controller โ 0A, 0B              โ
โ    LUN โ lun_001, lun_002, ...      โ
โ    Disk โ disk_01, disk_02, ...     โ
โ    (ัะพะปัะบะพ ะดะปั ะฒัะฑัะฐะฝะฝะพะณะพ Resource) โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### ะกัะตะฝะฐัะธะน 1: ะะพะบะฐะทะฐัั ะฒัะต ะดะฐะฝะฝัะต ะผะฐััะธะฒะฐ
```
SN: 2102353TJWFSP3100020
Resource: All
Element: All
```
ะะพะบะฐะถะตั ะฒัะต ะณัะฐัะธะบะธ ะดะปั ะฒัะตั ัะตััััะพะฒ ะธ ัะปะตะผะตะฝัะพะฒ.

### ะกัะตะฝะฐัะธะน 2: ะขะพะปัะบะพ ะบะพะฝััะพะปะปะตัั
```
SN: 2102353TJWFSP3100020
Resource: Controller
Element: All
```
ะ ะฟะตัะตะผะตะฝะฝะพะน Element ะฑัะดัั ัะพะปัะบะพ: 0A, 0B
ะะพะบะฐะถะตั ะณัะฐัะธะบะธ ัะพะปัะบะพ ะดะปั ะบะพะฝััะพะปะปะตัะพะฒ.

### ะกัะตะฝะฐัะธะน 3: ะขะพะปัะบะพ ะพะดะธะฝ ะบะพะฝััะพะปะปะตั
```
SN: 2102353TJWFSP3100020
Resource: Controller
Element: 0A
```
ะะพะบะฐะถะตั ะณัะฐัะธะบะธ ัะพะปัะบะพ ะดะปั ะบะพะฝััะพะปะปะตัะฐ 0A.

### ะกัะตะฝะฐัะธะน 4: ะัะต LUN
```
SN: 2102353TJWFSP3100020
Resource: LUN
Element: All
```
ะะพะบะฐะถะตั ะณัะฐัะธะบะธ ะดะปั ะฒัะตั LUN ะผะฐััะธะฒะฐ.

## ะัะพะฒะตัะบะฐ ะธัะฟัะฐะฒะปะตะฝะธะน

### 1. ะัะบัะพะนัะต ะดะฐัะฑะพัะด
http://localhost:3000 โ Dashboards โ "Huawei OceanStor - Real Data"

### 2. ะัะพะฒะตัััะต ะฟะตัะตะผะตะฝะฝัะต ะฒ ัะฐะฟะบะต
ะะพะปะถะฝั ะฑััั:
- โ SN (ั ะพะฟะธัะฐะฝะธะตะผ "ะกะตัะธะนะฝัะน ะฝะพะผะตั ะผะฐััะธะฒะฐ")
- โ Resource (ั ะพะฟะธัะฐะฝะธะตะผ "ะขะธะฟ ัะตััััะฐ...")
- โ Element (ั ะพะฟะธัะฐะฝะธะตะผ "ะญะปะตะผะตะฝั...")

ะะ ะดะพะปะถะฝะพ ะฑััั:
- โ array

### 3. ะัะฑะตัะธัะต SN
ะัะฑะตัะธัะต: 2102353TJWFSP3100020
- โ ะะพะปะถะฝะพ ะฟะพะบะฐะทะฐัั ะทะฝะฐัะตะฝะธะต ะฒ ะฒัะฟะฐะดะฐััะตะผ ัะฟะธัะบะต

### 4. ะัะพะฒะตัััะต Resource
ะัะฑะตัะธัะต: Controller
- โ ะ Element ะดะพะปะถะฝั ะฟะพัะฒะธัััั ัะพะปัะบะพ: 0A, 0B

ะัะฑะตัะธัะต: LUN  
- โ ะ Element ะดะพะปะถะฝั ะฟะพัะฒะธัััั LUN ัะปะตะผะตะฝัั

### 5. ะัะพะฒะตัััะต ะทะฐะณะพะปะพะฒะบะธ ะฟะฐะฝะตะปะตะน
ะะฐะทะฒะตัะฝะธัะต ัะตะบัะธั "Controller"
- โ ะะฐะณะพะปะพะฒะบะธ: "CPU Usage (%)", "Cache Hit Ratio (%)" ะธ ั.ะด.
- โ ะะ ะดะพะปะถะฝะพ ะฑััั: "Unknown_Controller"

### 6. ะัะพะฒะตัััะต ะณัะฐัะธะบะธ
ะัะฑะตัะธัะต Element: 0A
- โ ะัะฐัะธะบะธ ะดะพะปะถะฝั ะฟะพะบะฐะทัะฒะฐัั ะดะฐะฝะฝัะต
- โ ะ ะปะตะณะตะฝะดะต ะดะพะปะถะฝะพ ะฑััั: "0A"

## ะคะฐะนะปั ะบะพัะพััะต ะฑัะปะธ ะธะทะผะตะฝะตะฝั

1. **build_dashboard_from_real_data.py**
   - ะัะฟัะฐะฒะปะตะฝ ะผะฐะฟะฟะธะฝะณ ัะตััััะพะฒ (ัะฑัะฐะฝ ะฟัะตัะธะบั "Unknown_")

2. **generate_dashboard_fixed.py**
   - ะะทะผะตะฝะตะฝ label ั `array` ะฝะฐ `SN`
   - ะะฑะฝะพะฒะปะตะฝั ะทะฐะฟัะพัั ะฒ ะฟะฐะฝะตะปัั

3. **generate_dashboard_real.py**
   - ะะพะฑะฐะฒะปะตะฝะฐ ะฟะตัะตะผะตะฝะฝะฐั `$Resource`
   - ะะฐัััะพะตะฝะฐ ะบะฐัะบะฐะดะฝะฐั ัะธะปัััะฐัะธั
   - ะะพะฑะฐะฒะปะตะฝั ะพะฟะธัะฐะฝะธั ะบ ะฟะตัะตะผะตะฝะฝัะผ

4. **resource_metric_mapping_real.py**
   - ะัะฟัะฐะฒะปะตะฝั ะฝะฐะทะฒะฐะฝะธั ัะตััััะพะฒ
   - "Controller" ะฒะผะตััะพ "Unknown_Controller"

5. **grafana/provisioning/dashboards/Huawei-OceanStor-Real-Data.json**
   - ะะฑะฝะพะฒะปะตะฝ ะฐะฒัะพะผะฐัะธัะตัะบะธ ะณะตะฝะตัะฐัะพัะพะผ

## ะกะปะตะดัััะธะต ัะฐะณะธ

ะัะปะธ ะฒ ะฑัะดััะตะผ ะฟะพะฝะฐะดะพะฑะธััั ะฟะตัะตัะพะทะดะฐัั ะดะฐัะฑะพัะด:

```bash
# 1. ะะตัะตัะพะทะดะฐัั ะผะฐะฟะฟะธะฝะณ ะธะท CSV (ะตัะปะธ ะฝัะถะฝะพ)
python3 build_dashboard_from_real_data.py

# 2. ะะปะธ ะฟัะพััะพ ะฟะตัะตัะพะทะดะฐัั ะดะฐัะฑะพัะด ะธะท ัััะตััะฒัััะตะณะพ ะผะฐะฟะฟะธะฝะณะฐ
python3 generate_dashboard_real.py

# 3. ะะตัะตะทะฐะฟัััะธัั Grafana
docker compose restart grafana
```

## ะัะพะณ

โ ะัะต ะฟัะพะฑะปะตะผั ัะตัะตะฝั:
- ะคะธะปัััะฐัะธั ะฟะพ ัะตัะธะนะฝะพะผั ะฝะพะผะตัั ะผะฐััะธะฒะฐ ัะฐะฑะพัะฐะตั
- ะะพะฑะฐะฒะปะตะฝะฐ ัะธะปัััะฐัะธั ะฟะพ ัะธะฟั ัะตััััะฐ
- ะะฐัะบะฐะดะฝะฐั ัะธะปัััะฐัะธั ัะปะตะผะตะฝัะพะฒ
- ะัะฐะฒะธะปัะฝัะต ะฝะฐะทะฒะฐะฝะธั ะฒ ะทะฐะณะพะปะพะฒะบะฐั
- 775 ะฟะฐะฝะตะปะตะน ั ัะตะฐะปัะฝัะผะธ ะผะตััะธะบะฐะผะธ
