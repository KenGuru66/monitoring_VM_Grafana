â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  PERFMONKEY FORMAT CONVERTER - COMPLETE GUIDE
  Controllers & Disks
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

OVERVIEW
--------
Python/R scripts to convert Huawei performance data to PerfMonkey format.

AVAILABLE PARSERS:
1. CONTROLLER Parser (R script) - for CPU/Controller metrics
2. DISK Parser (Python script) - for Disk metrics

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“Š PART 1: CONTROLLER PARSER (Python - RECOMMENDED!)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

SCRIPT: perfmonkey/R_script/parse_1cpu_perfmonkey.py

FEATURES:
âœ“ Automatic Serial Number extraction
âœ“ Correct time preservation (no timezone conversion)
âœ“ Separate files for each controller
âœ“ No quotes (PerfMonkey compatible)
âœ“ Metric name cleaning
âœ“ 3.3x faster than R script
âœ“ 2.3x less memory than R script

PERFORMANCE:
  â€¢ Time: 1.76 seconds
  â€¢ Memory: 67 MB
  â€¢ CPU: Single-threaded

USAGE:
------
# Step 1: Create controller data file
FILE="2102353TJWFSP3100020.csv"
echo "Resource;Metric;InstanceName;Value;Time;UnixTime" > ${FILE}_cpu_all
awk -F';' '$1 == "Controller"' ${FILE} >> ${FILE}_cpu_all

# Step 2: Run Python script (RECOMMENDED)
python3 perfmonkey/R_script/parse_1cpu_perfmonkey.py ${FILE}_cpu_all

# Output: Separate files for each controller
#   2102353TJWFSP3100020_0A_output.csv
#   2102353TJWFSP3100020_0B_output.csv

ALTERNATIVE (R script - has timezone bug):
  Rscript perfmonkey/R_script/parse_1cpu_perfmonkey.R ${FILE}_cpu_all
  Note: R version converts time -2 hours (UTC issue)

EXAMPLE OUTPUT FORMAT:
----------------------
CPUPERF,#,BgnDateTime,EndDateTime,Serial,Slot,Type,<103 metrics>

CPUPERF,1,09/11/25 00:05:00,09/11/25 00:05:00,2102353TJWFSP3100020,0A,5000V6,...
CPUPERF,2,09/11/25 00:06:00,09/11/25 00:06:00,2102353TJWFSP3100020,0A,5000V6,...
...

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ’¾ PART 2: DISK PARSER (NEW!)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

SCRIPT: perfmonkey/R_script/parse_disk_perfmonkey_single.py

FEATURES:
âœ“ Memory-efficient (< 2 GB for 200+ GB files)
âœ“ Fast processing (40 seconds for 2.6M rows)
âœ“ Single file output (all disks in ONE file)
âœ“ Automatic Serial Number extraction
âœ“ Time sorting (chronological)
âœ“ Skips empty rows
âœ“ No quotes (PerfMonkey compatible)

USAGE:
------
# Step 1: Create disk data file
FILE="2102353TJWFSP3100020.csv"
echo "Resource;Metric;InstanceName;Value;Time;UnixTime" > ${FILE}_disk_all
awk -F';' '$1 == "Disk"' ${FILE} | grep -v "Domain" >> ${FILE}_disk_all

# Step 2: Run Python script
python3 perfmonkey/R_script/parse_disk_perfmonkey_single.py ${FILE}_disk_all

# Output: ONE file for ALL disks
#   2102353TJWFSP3100020_DISK_PERFMONKEY.csv

EXAMPLE OUTPUT FORMAT:
----------------------
RGPERF,#,BgnDateTime,EndDateTime,Serial,MpCnt,Rg,PgCnt,LdCnt,Alias,<36 metrics>

RGPERF,1,09/11/25 00:05:00,09/11/25 00:05:00,2102353TJWFSP3100020,1,CTE0.0,1,1,-,119,6656,...
RGPERF,1,09/11/25 00:05:00,09/11/25 00:05:00,2102353TJWFSP3100020,1,CTE0.10,1,1,-,120,6656,...
RGPERF,1,09/11/25 00:05:00,09/11/25 00:05:00,2102353TJWFSP3100020,1,CTE0.12,1,1,-,116,6656,...
...
RGPERF,2,09/11/25 00:06:00,09/11/25 00:06:00,2102353TJWFSP3100020,1,CTE0.0,1,1,-,150,6656,...
RGPERF,2,09/11/25 00:06:00,09/11/25 00:06:00,2102353TJWFSP3100020,1,CTE0.1,1,1,-,181,6656,...

Note: All disks for each timepoint share the same Row #

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸš€ COMPLETE WORKFLOW EXAMPLE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# 1. Generate CSV from binary logs
cd Data2csv
python3 Huawei_perf_parser_v0.2_parallel.py logs/Storage_History_Performance_Files.zip

# 2. Process Controllers
FILE="2102353TJWFSP3100020.csv"
echo "Resource;Metric;InstanceName;Value;Time;UnixTime" > ${FILE}_cpu_all
awk -F';' '$1 == "Controller"' ${FILE} >> ${FILE}_cpu_all
Rscript ../perfmonkey/R_script/parse_1cpu_perfmonkey.R ${FILE}_cpu_all

# 3. Process Disks
echo "Resource;Metric;InstanceName;Value;Time;UnixTime" > ${FILE}_disk_all
awk -F';' '$1 == "Disk"' ${FILE} | grep -v "Domain" >> ${FILE}_disk_all
python3 ../perfmonkey/R_script/parse_disk_perfmonkey_single.py ${FILE}_disk_all

# 4. Import to PerfMonkey
#    - Controllers: 2102353TJWFSP3100020_0A_output.csv
#    - Controllers: 2102353TJWFSP3100020_0B_output.csv  
#    - Disks: 2102353TJWFSP3100020_DISK_PERFMONKEY.csv

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ˆ PERFORMANCE COMPARISON
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DISK PARSER:
------------
Old R Script (parse_disk.R):
  â€¢ Time: 5+ minutes
  â€¢ Memory: 25-30 GB
  â€¢ Status: Crashes on large files (> 10 GB)

New Python Script (parse_disk_perfmonkey_single.py):
  â€¢ Time: ~40 seconds (7.5x faster)
  â€¢ Memory: < 2 GB (92% less)
  â€¢ Status: Works with files 200+ GB

CONTROLLER PARSER:
------------------
Old R Script (parse_1cpu_perfmonkey.R):
  â€¢ Time: 5.73 seconds
  â€¢ Memory: 153 MB
  â€¢ Status: Works, but has timezone bug (-2 hours)

New Python Script (parse_1cpu_perfmonkey.py):
  â€¢ Time: 1.76 seconds (3.3x faster)
  â€¢ Memory: 67 MB (56% less)
  â€¢ Status: Works correctly, no timezone issues

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… VALIDATION CHECKS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Controller Files:
âœ“ No quotes
âœ“ Serial Number extracted from filename
âœ“ Time sorted chronologically
âœ“ Separate file per controller
âœ“ Row numbers start from 1

Disk Files:
âœ“ No quotes
âœ“ Serial Number extracted from filename
âœ“ Time sorted chronologically
âœ“ All disks in ONE file
âœ“ Empty rows skipped
âœ“ Row # same for all disks at same time

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“š DOCUMENTATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

perfmonkey/DISK_PARSER_README.txt - Detailed disk parser docs
perfmonkey/R_script/howto.txt - Original R script instructions
perfmonkey/QUICK_START.txt - Controller quick start

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

